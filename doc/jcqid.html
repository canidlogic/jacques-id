<!DOCTYPE html>
<!-- Auto-generated by Bark -->
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Jacques-ID specification</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link href="SourceFonts.css" rel="stylesheet"/>
    <style>

body {
  max-width: 35em;
  padding-left: 0.25em;
  padding-right: 0.25em;
  margin-left: auto;
  margin-right: auto;
  margin-bottom: 3.5em;
  font-family: 'Source Serif', serif;
  background-color: WhiteSmoke;
  color: black;
}

:link {
  text-decoration: none;
  color: blue
}

:visited {
  text-decoration: none;
  color: blue
}

.tt {
  font-family: 'Source Code Pro', monospace;
  background-color: LightGray;
}

hr {
  margin-top: 2.5em;
}

#toc {
  background-color: white;
  padding: 0.5em;
  border: thin solid;
  margin-bottom: 1.5em;
  font-family: 'Source Sans 3', sans-serif;
}

#tochead {
  text-align: center;
  font-weight: bold;
  margin-bottom: 1em;
}

#toc ul {
  margin-top: 0;
  margin-bottom: 0;
  padding-left: 1.5em;
  padding-right: 1.5em;
}

h1 {
  font-family: 'Source Sans 3', sans-serif;
  margin-bottom: 0;
  text-align: center;
}

#verline {
  font-family: 'Source Sans 3', sans-serif;
  font-size: 150%;
  text-align: center;
}

h2 {
  font-family: 'Source Sans 3', sans-serif;
}

h3 {
  font-family: 'Source Sans 3', sans-serif;
}

h4 {
  font-family: 'Source Sans 3', sans-serif;
}

li {
  font-family: 'Source Sans 3', sans-serif;
}

#footline {
  font-size: smaller;
  text-align: right;
}

.iblock {
  font-family: 'Source Sans 3', sans-serif;
}

.explain {
  font-size: smaller;
}

.cblock {
  background-color: white;
  color: indigo;
  padding: 0.5em;
  font-family: 'Source Code Pro', monospace;
  border: thin dotted;
  overflow: auto;
}

.chead {
  text-decoration: underline;
  margin-top: 1em;
  margin-bottom: 1em;
}

.chead:first-child {
  margin-top: 0;
}

.ci {
  margin-left: 2em;
  margin-top: 1em;
}

#titlebox {
  background-color: white;
  margin-top: 3em;
  margin-bottom: 3em;
  padding-top: 0.5em;
  padding-bottom: 1.5em;
  border: medium double;
}

    </style>
  </head>
  <body>

<div id="titlebox">
<h1>Jacques-ID specification</h1>
<div id="verline">Version 1.0</div>
</div>

<div id="toc">
<div id="tochead">Table of Contents</div>
<ul>
  <li>1. <a href="#sec1">Introduction</a></li>
  <li>2. <a href="#sec2">ID format</a>
    <ul>
      <li>2.1 <a href="#sec2p1">Hour count</a></li>
      <li>2.2 <a href="#sec2p2">Second count</a></li>
      <li>2.3 <a href="#sec2p3">Random portion</a></li>
    </ul>
  </li>
</ul>
<div> </div>
<ul>
  <li>A. <a href="#secA">External references</a></li>
  <li>B. <a href="#secB">Building the specification</a></li>
  <li>C. <a href="#secC">Specification license</a></li>
</ul>
</div>

<h2 id="sec1">1. Introduction</h2>

<p>Jacques-ID is a simple system for generating 63-bit unique identification numbers through a combination of random and time-​based processes.</p>

<p>ID codes generated by this module are intended for use as permanent identification numbers.  The advantage of using a Jacques-ID code instead of just the auto-​increment primary key in a SQL table is that the ID code is independent from the physical layout of the data table and it is also much more difficult to guess or derive other sorts of information, such as how many records there are in the table.  The advantage of using a Jacques-ID code instead of just a purely random identification code is that Jacques-ID uses time-​based components to provide hard guarantees against collisions.</p>

<h2 id="sec2">2. ID format</h2>

<p>The output format of a Jacques-ID code is always a 63-bit integer that has a value greater than zero.  This allows Jacques-ID codes to be stored in both signed and unsigned 64-bit integers, and it allows zero and negative values to be used as special values that will never be a valid Jacques-ID code.</p>

<p>The structure of a Jacques-ID is as follows, ordered from most significant bits to least significant bits:</p>

<ol>
<li><b>24 bits:</b> (pseudo-)​random bits
<li><b>12 bits:</b> seconds within the hour or overflow</li>
<li><b>27 bits:</b> hours since Unix epoch</li>
</ol>

<p>The client does not actually need to know about this ID structure, but it is documented here for completeness.  The following subsections describe the parts of the ID structure in further detail.</p>

<h3 id="sec2p1">2.1 Hour count</h3>

<p>The 27 least significant bits of the Jacques-ID code counts the number of <i>hours</i> that have elapsed since the Unix epoch on midnight GMT at the start of January 1, 1970.  This hour counter can count all the way until the end of the Gregorian year 9999 without overflowing.  Jacques-ID is therefore not subject to the “Year 2038 problem,” <a href="#extP2038">[P-2038]</a>.</p>

<p>There are two largely theoretical cases that are accounted for below that should never actually occur in the practice, though they might happen if something is wrong with the computerʼs timekeeping functionality.</p>

<p>The first theoretical case is when the hour count is near zero.  “Near zero” is defined to be any value less than 8760.  This shouldnʼt happen because the year would be 1970 and the Jacques-ID standard was only defined in 2021.  But itʼs possible that this could happen in practice if something is wrong with the system clock.  If the system clock suggests that less than 8760 hours have passed since the Unix epoch, then Jacques-ID will assume the system clock is out of order and instead set the whole ID to 63 randomly chosen bits, except that it is not acceptable for all bits to be zero.</p>

<p>The second theoretical case is when the hour count would overflow.  As mentioned earlier, this would suggest that the current time is well beyond the Gregorian year 9999.  In this case, Jacques-ID will assume once again that the system clock is out of order and instead set the whole ID to 63 randomly chosen bits, with the restriction that at least one bit must be non-​zero.</p>

<h3 id="sec2p2">2.2 Second count</h3>

<p>The 12 bits above the hour count normally counts the seconds that have elapsed within the hour indicated by the hour count.  In case of timer malfunction as described in §2.1 <a href="#sec2p1">Hour count</a>, the second count will be set to random bits.  Otherwise, it is a value in range [0, 3599] that selects a specific second within the hour.</p>

<p>However, the 12 bits assigned to the second count allow for values all the way up to 4095.  The values in range [3600, 4095] are <i>overflow</i> values.  If many ID values are assigned at the same time such that it becomes too difficult to find unique values, then these overflow values can be used to store extra values.  The overflow values therefore act as a buffer so that a sudden spike in requirements for unique IDs can be handled.  See @@TODO: for further information.</p>

<h3 id="sec2p3">2.3 Random portion</h3>

<p>The 24 most significant bits of the 63-bit ID code are always (pseudo-)​randomly chosen using a cryptographically secure source of randomness.</p>

<p>Factoring in the time components described in previous subsections, each second there are 16,777,216 different random IDs that can be generated, none of which will ever be reused during any other second.  In case that is somehow not enough, each hour can use the <a href="#sec2p2">overflow values in the second count</a> (§2.2) which unlocks 8,321,499,136 additional overflow IDs that will never be reused during any other hour.</p>

<hr/>

<h2 id="secA">A. External references</h2>

<p id="extBark">[BARK] — Bark project<br/>
Canidtech<br/>
<a href="https://www.purl.org/canidtech/r/bark">https://www.purl.org/canidtech/r/bark</a></p>

<p id="extP2038">[P-2038] — “The Project 2038 Frequently Asked Questions (FAQ)”<br/>
<a href="http://maul.deepsky.com/~merovech/2038.html">http://maul.deepsky.com/~merovech/2038.html</a></p>

<h2 id="secB">B. Building the specification</h2>

<p>The HTML source code of this specification is auto-generated by <a href="#extBark">[BARK]</a> from the <a href="jcqid.html.bark">jcqid.html.bark</a> source file.  Changes should be made to the Bark source file, which should then be recompiled with Bark, instead of directly modifying the HTML code.</p>

<p>The webfonts used to render this specification are included in the <span class="tt">fonts</span> subdirectory.  Please see the <a href="fonts/README.txt">README</a> file in that subdirectory for further information about the webfonts and their licenses.</p>

<h2 id="secC">C. Specification license</h2>

<div>
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br />Jacques-ID Specification by Multimedia Data Technology Inc is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.<br />Permissions beyond the scope of this license may be available at <a href="https://www.canidtech.com/">https://www.canidtech.com/</a>.
</div>

<hr/>
<div id="footline">
Multimedia Data Technology, Inc.<br/>
<a href="https://www.canidtech.com/">www.canidtech.com</a><br/>
<br/>
Written by Noah Johnson<br/>
<span class="tt">noah.johnson@loupmail.com</span><br/>
<br/>
May 2021
</div>

  </body>
</html>
